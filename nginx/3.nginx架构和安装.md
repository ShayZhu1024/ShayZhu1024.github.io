# 3.nginx架构和安装

## Netcraft公司web网站服务器分析

https://www.netcraft.com/resources/?type=blog


## apache

官网  https://www.apache.org/

### apache 架构演进


####  Apache prefork 模型

<img src="../images/apachePrefork01.png">

* 优点：稳定
* 缺点：每个用户请求需要对应开启一个进程,占用资源较多，并发性差,不适用于高并发场景

#### Apache worker 模型

<img src="../images/apacheprefork02.png">


* 优点：
  * 相比prefork 占用的内存较少，可以同时处理更多的请求,可以基于select的IO多路复用技术实现
  * 使用更少的线程支持更多的并发连接
* 缺点：
  * 使用keepalive的长连接方式，某个线程会一直被占据，即使没有传输数据，也需要一直等待到超时才会被释放
  * 如果过多的线程，被这样占据，也会导致在高并发场景下的无服务线程可用（该问题在prefork模式下，同样会发生）


#### Apache event 模型


<img src="../images/apacheprefork03.png">


* 优点：
  * 单线程响应多请求，占据更少的内存，高并发下表现更优秀，会有一个专门的线程来管理keepalive类型的线程
  * 当有真实请求过来的时候，将请求传递给服务线程，执行完毕后，又允许它释放
  * 可以基于epoll 更加高效的IO多路复用技术实现使用更少的线程支持更多的并发连接
* 缺点：没有线程安全控制

