# MySQL备份还原和主从复制集群

## mysqldump备份

```bash
InnoDB建议备份策略
mysqldump -uroot -p123456 -A -F -E -R --triggers --single-transaction --master-data=2 --flush-privileges --default-character-set=utf8mb4 --hex-blob > backup.sql

#新版8.0.26以上
mysqldump -uroot -p123456 -A -F -E -R --triggers --single-transaction --source-data=2 --flush-privileges --default-character-set=utf8mb4 --hex-blob > backup.sql

-A #备份所有数据库
-F #刷新日志
-E #导出事件
-R #导出存储过程以及自定义函数
--triggers #导出触发器
--single-transaction #以开启事务的方式备份数据
--master-data=2 #备份文件中记录二进制日志信息的备份点，默认注释掉，适合单机
--source-data=1 #备份文件中记录二进制日志信息的备份点，不会注释掉，适合主从
--flush-privileges #导出后刷新权限
--default-character-set=utf8mb4 #设置字符集
--hex-blob #使用十六进制转储二进制

MyISAM建议备份策略
mysqldump -uroot -p123456 -A -F -E -R -x --master-data=1 --flush-privileges --triggers --default-character-set=utf8mb4 --hex-blob > backup.sql
#选项说明
-uroot #MySQL用户名
-p123456 #MySQL密码
-A #备份所有数据库
-F #刷新日志
-E #导出事件
-R #导出存储过程以及自定义函数
-x #加全局读锁，备份完会自动解锁
--triggers #导出触发器
--master-data=2 #备份日志信息
--flush-privileges #导出后刷新权限
--default-character-set=utf8 #设置字符集
--hex-blob #使用十六进制转储二进制

还原数据库
mysql -uroot -p123456 < backup.sql

在备份日志中记录备份时的二进制日志信息，后续通过此备份进行恢复，还是会缺少一部份数据，这一部份数据，则可以通过当前的二进制日志与备份文件中的二进制信息进行对比得到
```

## xtrabackup 备份工具
