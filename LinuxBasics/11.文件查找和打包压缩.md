# 11.文件查找和打包压缩

## 1.非实时查找 locate

```bash
依赖于/var/lib/mlocate/mlocate.db
执行updatedb 可以更新数据库
locate和updatedb命令来自于mlocate包
搜索文件的全路径，不能指定路径
locate [OPTION]... [PATTERN]...
-i 不区分大小写的搜索
-n N 只列举前N个匹配项目
-r 使用基本正则表达式
```

## 2.实时文件查找 find

> find [OPTION]... [查找路径] [查找条件] [处理动作]


### 根据文件名和inode查找


```bash
-maxdepth level     #最大搜索目录深度,指定目录下的文件为第1级
-mindepth level     #最小搜索目录深度
-depth              #先处理目录内的文件在处理目录本身
-name '文件名称'     #支持使用glob,通配符要加双引号引起来
-iname '文件名称'    #不区分字母大小
-inum n             #按inode号查找
-samefile name      #相同inode号的文件
-links n            #链接数为n的文件
-regex 'pattern'    #以pattern来匹配整个文件路径，而非文件名称
```

### 根据属主，属组查找

```bash
-user       USERNAME 
-group     GRPNAME
-uid       UserID
-gid       GroupID
-nouser   #查找没有属主的文件
-nogroup  #查找没有属组的文件
```

### 根据文件类型查找

```bash

 -type
 
 f: 普通文件
 d: 目录文件
 l: 符号链接文件
 s: 套接字文件
 b: 块设备文件
 c: 字符设备文件
 p: 管道文件


```

### 空文件或者空目录

` -empty`

### 组合条件

```bash
 与： -a  不写默认就是与
 或： -o
 非： -not !
 注意： 在find的表达式写()分组需要转义
```

### 德摩根定律

```bash
 （非A）且（非B）=非（A或B）
 （非A）或（非B）=非（A且B）
```


### 排除目录

-path '目录路径' #排除这个


### 根据文件大小来查找

```bash
 -size [+|-] #UNIT  #常用单位K M G c(byte) 注意大小写敏感
 6K 表示  (5k, 6k]
 -6k 表示 [0,5k]
 +6k 表示 (6K, ∞)
```


### 根据时间戳

```bash
 以天为单位
 -atime [+|-] 时间
 -ctime [+|-] 时间
 -mtime [+|-] 时间
 6 [6,7)
 +6 [7, ∞]
 -6 [0, 6)
 以分钟为单位
 -amin
 -mmin
 cmin
```
### 根据权限查找

```bash
-perm [/|-] MODE
MODE  #精确匹配
/MODE #任何一类(u,g,o)对象的权限中只要有一位匹配即可，或关系用/ 不要用+ ，+从Centos7开始淘汰
-MODE #每一类对象都必须同时拥有指定关系 与关系，只要有这个权限，不是说必须精确匹配，包括/MODE 也是这个含义
0 权限数字位是0表示不关注

```

<img src="../images/findCondition01.png">


### 正则

```bash
-regex 
-regextype 正则类型
            posix-awk
            posix-basic
            posix-egrep
            posixextended
```


### 处理动作

```bash
-print  默认打印
-ls  
-fls  file  #查找到的所有文件的长格式信息保存至指定文件中
-delete 删除文件
-ok CMD () \; #对查找到的每个文件执行CMD，交互式与用户
-exec CMD {} \;  #对查找到的每个文件执行CMD非交互

find -name ".conf" -exec cp {} {}.orig \;
{}表示前面find找到的文件，写在这个位置相当于引用前面find找到的文件，
\;表示转义;告诉shell，这个;是要给find的不是给shell的表明-exec 到; 是作为find参数
关于 {} \;更加详细说明
https://askubuntu.com/questions/339015/what-does-mean-in-the-find-command


xargs 动态生成参数，动态从标准输入读
-n 数字  #多少个参数为一行
-null 或者 -0  #使用二进制0 来表示参数分隔符而不是空格 防止文件名中有空格而使用空格分隔符
会产生混淆情况发生
```









